const faker = require("faker");
const moment = require("moment");
const _ = require("lodash");

const listMileages = (vehicleId, { at_gt, at_lt }) => {
  const result = _.range(-500, 0)
    .map(i =>
      moment()
        .startOf("day")
        .add(i, "days")
    )
    .filter(at => at.diff(at_gt) >= 0 && at.diff(at_lt) <= 0)
    .map(at => ({
      at: at.format("YYYY-MM-DD"),
      mileage: faker.random.number({
        min: 0,
        max: 400,
        precision: 0.01,
      }),
    }));

  return result;
};

const listEnergyConsumptions = (vehicleId, { at_gt, at_lt }) => {
  const result = _.range(-500, 0)
    .map(i =>
      moment()
        .startOf("day")
        .add(i, "days")
    )
    .filter(at => at.diff(at_gt) >= 0 && at.diff(at_lt) <= 0)
    .map(at => ({
      at: at.format("YYYY-MM-DD"),
      discharge: faker.random.number({
        min: 0,
        max: 400,
        precision: 0.01,
      }),
    }));

  return result;
};

const genChartVehicles = (vehicles = []) => {
  // 每辆车生成今年的数据, 每日一条数据

  const ret = [];
  const start = moment().startOf("year");
  const end = moment()
    .add(1, "day")
    .startOf("day");

  for (const vehicle of vehicles) {
    // 按每天循环
    let lastMilesage = faker.random.number({ min: 10000, max: 30000 });
    let lastConsumption =
      (lastMilesage / 100) * faker.random.number({ min: 40, max: 60 });

    for (let day = moment(start); day.isBefore(end); day.add(1, "day")) {
      const mileageIncrement = faker.random.number({ min: 50, max: 200 });
      const consumptionIncrement = faker.random.number({ min: 40, max: 60 });

      lastMilesage += mileageIncrement;
      lastConsumption += consumptionIncrement;

      ret.push({
        at: day.toISOString(),
        vin: vehicle.id,
        ns: vehicle.ns,
        line: vehicle.line,
        no: vehicle.no,
        producer: vehicle.producer,
        modelBrief: vehicle.modelBrief,
        model: vehicle.model,
        mileage: lastMilesage,
        consumption: lastConsumption,
      });
    }
  }

  return ret;
};

const defaultVehicles = [
  {
    id: "FAKEMFVQFQYPT1O5C",
    vin: "FAKEMFVQFQYPT1O5C",
    brands: "LLC",
    capacity: 57,
    emission: "UNKNOWN",
    engineNo: "FAKE0AHTUZVP",
    iccid: "FAKE1Z31RY9A",
    length: 9,
    lifeYear: 12,
    line: "119路",
    model: "SLK6109ULE0BEVX",
    modelBrief: "L9E",
    modified: true,
    no: "L9E-CMUV",
    place: "42265 Ferne Point",
    plate: "沪CFAKEYCXLV",
    plateAt: "2019-01-21T09:21:56.193Z",
    powerBy: "混合动力",
    producer: "申龙",
    purchaseAt: "2018-09-15T11:20:38.898Z",
    remark: "expedita delectus quia",
    scrapped: false,
    seats: 48,
    type: "大型普通客车",
    validTill: "2031-01-21T09:21:56.193Z",
    ns: "/bus/company1",
    createdAt: "2019-03-02T04:01:17.391Z",
    updatedAt: "2019-10-27T14:18:26.536Z",
    state: "ONLINE",
  },
  {
    id: "FAKE1ILZF19KPY6N2",
    vin: "FAKE1ILZF19KPY6N2",
    brands: "Group",
    capacity: 36,
    emission: "UNKNOWN",
    engineNo: "FAKENFJM3V1C",
    iccid: "FAKE4383T01Q",
    length: 14,
    lifeYear: 11,
    line: "浦东62路",
    model: "SLK6109ULE0BEVX",
    modelBrief: "L0B",
    modified: true,
    no: "L0B-W9VY",
    place: "163 Tod Crossroad",
    plate: "沪AFAKE4CEQ6",
    plateAt: "2019-06-05T00:54:37.057Z",
    powerBy: "纯电动",
    producer: "申龙",
    purchaseAt: "2019-04-03T16:28:42.261Z",
    remark: "repellat magni similique",
    scrapped: true,
    seats: 52,
    type: "大型普通客车",
    validTill: "2030-06-05T00:54:37.057Z",
    ns: "/bus",
    createdAt: "2018-11-16T22:31:47.233Z",
    updatedAt: "2020-01-05T05:40:16.774Z",
    state: "ONLINE",
  },
  {
    id: "FAKERIMVG7YH35HKG",
    vin: "FAKERIMVG7YH35HKG",
    brands: "Group",
    capacity: 44,
    emission: "UNKNOWN",
    engineNo: "FAKE8PTY4VQ6",
    iccid: "FAKE2G95RJI0",
    length: 8,
    lifeYear: 11,
    line: "浦东1路",
    model: "ZK6105BEVG29",
    modelBrief: "SY",
    modified: false,
    no: "SY-PZKD",
    place: "2172 Reed Landing",
    plate: "沪AFAKE446KJ",
    plateAt: "2018-12-03T21:28:13.595Z",
    powerBy: "混合动力",
    producer: "宇通",
    purchaseAt: "2018-09-19T12:09:17.382Z",
    remark: "non doloremque autem",
    scrapped: true,
    seats: 58,
    type: "大型普通客车",
    validTill: "2029-12-03T21:28:13.595Z",
    ns: "/bus/company1/sub1",
    createdAt: "2019-03-27T23:33:04.212Z",
    updatedAt: "2020-05-27T20:41:30.163Z",
    state: "UNKNOWN",
  },
  {
    id: "FAKE6AIOJOSPQB85K",
    vin: "FAKE6AIOJOSPQB85K",
    brands: "LLC",
    capacity: 39,
    emission: "UNKNOWN",
    engineNo: "FAKEC66I5XT9",
    iccid: "FAKE6OKCUAP4",
    length: 15,
    lifeYear: 10,
    line: "611路",
    model: "ZK6125BEVG6",
    modelBrief: "Z0A",
    modified: true,
    no: "Z0A-AAFV",
    place: "480 Isaac Walk",
    plate: "沪AFAKEWUS7E",
    plateAt: "2019-02-25T18:19:46.285Z",
    powerBy: "混合动力",
    producer: "宇通",
    purchaseAt: "2019-06-15T11:09:56.942Z",
    remark: "omnis repellat et",
    scrapped: false,
    seats: 45,
    type: "大型普通客车",
    validTill: "2029-02-25T18:19:46.285Z",
    ns: "/bus/company2",
    createdAt: "2019-07-03T19:16:02.104Z",
    updatedAt: "2019-08-30T00:39:17.660Z",
    state: "GPS_ERROR",
  },
  {
    id: "FAKEQWEE5TI8D8TVY",
    vin: "FAKEQWEE5TI8D8TVY",
    brands: "Group",
    capacity: 48,
    emission: "UNKNOWN",
    engineNo: "FAKEROKEYGH2",
    iccid: "FAKEGPY1RXTA",
    length: 11,
    lifeYear: 9,
    line: "7路",
    model: "SXC6120GHEV",
    modelBrief: "W1C",
    modified: false,
    no: "W1C-I93H",
    place: "34966 Vandervort Mills",
    plate: "沪AFAKELCOTV",
    plateAt: "2018-10-06T20:41:58.769Z",
    powerBy: "混合动力",
    producer: "万象",
    purchaseAt: "2018-08-14T05:33:48.152Z",
    remark: "reprehenderit voluptatem et",
    scrapped: false,
    seats: 39,
    type: "大型普通客车",
    validTill: "2027-10-06T20:41:58.769Z",
    ns: "/bus/company1/sub2",
    createdAt: "2018-11-28T05:08:30.474Z",
    updatedAt: "2020-05-15T11:23:38.090Z",
    state: "GPS_ERROR",
  },
  {
    id: "FAKEP40H9YZ5GC236",
    vin: "FAKEP40H9YZ5GC236",
    brands: "and Sons",
    capacity: 47,
    emission: "UNKNOWN",
    engineNo: "FAKEKZ5GXZOB",
    iccid: "FAKEFPRCIJZ4",
    length: 7,
    lifeYear: 9,
    line: "浦东1路",
    model: "ZK6125BEVG25",
    modelBrief: "Z2E",
    modified: false,
    no: "Z2E-BWEE",
    place: "5932 Blaise Path",
    plate: "沪BFAKEBTTDB",
    plateAt: "2018-08-17T18:39:05.069Z",
    powerBy: "纯电动",
    producer: "宇通",
    purchaseAt: "2019-04-06T07:37:02.419Z",
    remark: "omnis cum saepe",
    scrapped: false,
    seats: 48,
    type: "大型普通客车",
    validTill: "2027-08-17T18:39:05.069Z",
    ns: "/bus/company1/sub1",
    createdAt: "2018-12-24T03:01:28.370Z",
    updatedAt: "2020-04-10T17:53:41.255Z",
    state: "OFFLINE",
  },
  {
    id: "FAKEMW2U2ELDN1ZWK",
    vin: "FAKEMW2U2ELDN1ZWK",
    brands: "LLC",
    capacity: 33,
    emission: "UNKNOWN",
    engineNo: "FAKE75XRIXMZ",
    iccid: "FAKEURYQ0Y6X",
    length: 13,
    lifeYear: 10,
    line: "52路(外环路)",
    model: "SWB6128EV56",
    modelBrief: "S2U",
    modified: false,
    no: "S2U-09W0",
    place: "18874 Corrine Centers",
    plate: "沪AFAKEG4WHO",
    plateAt: "2019-02-24T14:45:56.632Z",
    powerBy: "纯电动",
    producer: "申沃",
    purchaseAt: "2018-10-19T05:40:37.419Z",
    remark: "sapiente reiciendis magnam",
    scrapped: false,
    seats: 58,
    type: "大型普通客车",
    validTill: "2029-02-24T14:45:56.632Z",
    ns: "/bus/company1/sub1",
    createdAt: "2019-03-27T10:59:49.009Z",
    updatedAt: "2020-06-28T00:41:46.213Z",
    state: "OFFLINE",
  },
  {
    id: "FAKEEQDQ658ZX3U10",
    vin: "FAKEEQDQ658ZX3U10",
    brands: "Inc",
    capacity: 43,
    emission: "UNKNOWN",
    engineNo: "FAKEMJITBBMM",
    iccid: "FAKEE4BWVKTO",
    length: 9,
    lifeYear: 12,
    line: "浦东2路",
    model: "SLK6929ULE0BEVS1",
    modelBrief: "L0B",
    modified: true,
    no: "L0B-S2CN",
    place: "617 Wyatt Ramp",
    plate: "沪DFAKE78Z6Z",
    plateAt: "2019-05-22T19:29:41.654Z",
    powerBy: "纯电动",
    producer: "申龙",
    purchaseAt: "2018-11-07T23:35:25.304Z",
    remark: "quae fugiat vel",
    scrapped: false,
    seats: 47,
    type: "大型普通客车",
    validTill: "2031-05-22T19:29:41.654Z",
    ns: "/bus",
    createdAt: "2018-08-05T03:24:55.742Z",
    updatedAt: "2020-02-19T00:54:09.234Z",
    state: "OFFLINE",
  },
  {
    id: "FAKETDPYMMW6FWC84",
    vin: "FAKETDPYMMW6FWC84",
    brands: "Group",
    capacity: 42,
    emission: "UNKNOWN",
    engineNo: "FAKEFWG16DXD",
    iccid: "FAKEJH8YENV4",
    length: 9,
    lifeYear: 10,
    line: "62路",
    model: "SXC6105GBEV",
    modelBrief: "W1D",
    modified: true,
    no: "W1D-DETD",
    place: "580 Selena Tunnel",
    plate: "沪CFAKEIO0O3",
    plateAt: "2018-09-25T03:41:39.482Z",
    powerBy: "纯电动",
    producer: "万象",
    purchaseAt: "2019-07-03T07:11:45.777Z",
    remark: "autem non hic",
    scrapped: true,
    seats: 44,
    type: "大型普通客车",
    validTill: "2028-09-25T03:41:39.482Z",
    ns: "/bus/company1/sub2",
    createdAt: "2018-10-10T11:37:27.805Z",
    updatedAt: "2020-03-29T05:57:57.302Z",
    state: "ONLINE",
  },
  {
    id: "FAKEZWUXJ0O77KPLE",
    vin: "FAKEZWUXJ0O77KPLE",
    brands: "and Sons",
    capacity: 61,
    emission: "UNKNOWN",
    engineNo: "FAKEPAU41F0V",
    iccid: "FAKE5FZOXC4W",
    length: 10,
    lifeYear: 11,
    line: "浦东1路",
    model: "SXC6110GBEV3",
    modelBrief: "W1C",
    modified: true,
    no: "W1C-44YT",
    place: "834 King Light",
    plate: "沪AFAKE7KJAN",
    plateAt: "2019-01-27T22:28:43.360Z",
    powerBy: "纯电动",
    producer: "万象",
    purchaseAt: "2018-08-25T02:41:13.489Z",
    remark: "voluptatem iusto et",
    scrapped: false,
    seats: 58,
    type: "大型普通客车",
    validTill: "2030-01-27T22:28:43.360Z",
    ns: "/bus/company1/sub1",
    createdAt: "2018-10-11T08:01:11.035Z",
    updatedAt: "2019-09-02T01:53:05.774Z",
    state: "GPS_ERROR",
  },
];

module.exports = {
  listMileages,
  listEnergyConsumptions,
  genChartVehicles,
  defaultVehicles,
};
